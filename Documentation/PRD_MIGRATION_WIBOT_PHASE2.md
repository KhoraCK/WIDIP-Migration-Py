# PRD - Migration WIBOT & Dashboard UnifiÃ©
## Phase 2 : Plateforme WIDIP UnifiÃ©e

**Version:** 1.0
**Date:** 2026-01-06
**Auteur:** Migration Team
**Statut:** Draft - ValidÃ© en discussion

---

## Table des matiÃ¨res

1. [Vision & Objectifs](#1-vision--objectifs)
2. [Architecture Cible](#2-architecture-cible)
3. [Modules Fonctionnels](#3-modules-fonctionnels)
4. [SpÃ©cifications Techniques](#4-spÃ©cifications-techniques)
5. [Structure du Projet](#5-structure-du-projet)
6. [SÃ©curitÃ©](#6-sÃ©curitÃ©)
7. [Plan de Migration](#7-plan-de-migration)
8. [Roadmap DÃ©taillÃ©e](#8-roadmap-dÃ©taillÃ©e)

---

## 1. Vision & Objectifs

### 1.1 Contexte

Suite Ã  la Phase 1 (migration des workflows n8n vers Python), la Phase 2 vise Ã  :
- **Migrer le backend WIBOT** (n8n â†’ Python/FastAPI)
- **CrÃ©er une plateforme unifiÃ©e** regroupant tous les outils WIDIP
- **Connecter le SAFEGUARD** Phase 1 au frontend
- **Ajouter des dashboards de supervision** pour les workflows

### 1.2 Objectifs Phase 2

1. **Unifier le backend** : Un seul service FastAPI (port 3002) pour tout
2. **Conserver le frontend WIBOT** : RÃ©utiliser le code React existant
3. **Ajouter un menu principal** : Navigation entre WIBOT, SAFEGUARD, Supervision
4. **CrÃ©er des dashboards** : Monitoring temps rÃ©el des workflows Phase 1
5. **AmÃ©liorer la sÃ©curitÃ©** : bcrypt, JWT renforcÃ©, audit logs

### 1.3 Ce qui NE change PAS

- âŒ Le MCP Server (port 3001, inchangÃ©)
- âŒ Le RAG workflow n8n (conservÃ© par choix)
- âŒ Les workflows Python Phase 1 (dÃ©jÃ  migrÃ©s)
- âŒ Le schÃ©ma de base principal

### 1.4 Vision finale

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      WIDIP UNIFIED PLATFORM                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    MENU PRINCIPAL                                â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â”‚  â”‚ ğŸ¤– WIBOT â”‚ â”‚ğŸ›¡ï¸SAFEGUARDâ”‚ â”‚ğŸ“Š SUPERVISIONâ”‚ â”‚ ğŸ‘¥ UTILISATEURSâ”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                                          â”‚
â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚       â”‚                      â”‚                      â”‚                   â”‚
â”‚       â–¼                      â–¼                      â–¼                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚   WIBOT     â”‚      â”‚  SAFEGUARD  â”‚      â”‚    SUPERVISION      â”‚    â”‚
â”‚  â”‚   (Chat)    â”‚      â”‚  (Approvals)â”‚      â”‚    (Dashboards)     â”‚    â”‚
â”‚  â”‚             â”‚      â”‚             â”‚      â”‚                     â”‚    â”‚
â”‚  â”‚ â€¢ Flash     â”‚      â”‚ â€¢ Pending   â”‚      â”‚ â€¢ Overview          â”‚    â”‚
â”‚  â”‚ â€¢ Code      â”‚      â”‚ â€¢ History   â”‚      â”‚ â€¢ SUPPORT           â”‚    â”‚
â”‚  â”‚ â€¢ RÃ©daction â”‚      â”‚ â€¢ Stats     â”‚      â”‚ â€¢ SENTINEL          â”‚    â”‚
â”‚  â”‚ â€¢ Assistant â”‚      â”‚ â€¢ Real-time â”‚      â”‚ â€¢ ENRICHISSEUR      â”‚    â”‚
â”‚  â”‚   WIDIP ğŸ†•  â”‚      â”‚   updates   â”‚      â”‚ â€¢ SAFEGUARD         â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. Architecture Cible

### 2.1 Backend UnifiÃ© (Port 3002)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    WIDIP UNIFIED BACKEND                                â”‚
â”‚                      FastAPI (Port 3002)                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                         API ROUTES                               â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  /api/auth/                    # Authentification               â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ POST /login               # JWT login                      â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ POST /logout              # Invalidate token               â”‚   â”‚
â”‚  â”‚  â””â”€â”€ GET  /me                  # Current user info              â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  /api/chat/                    # WIBOT Chat                     â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ POST /message             # Send message (streaming SSE)   â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ GET  /conversations       # List conversations             â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ POST /conversations       # Create conversation            â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ DELETE /conversations/:id # Delete conversation            â”‚   â”‚
â”‚  â”‚  â””â”€â”€ GET  /tokens              # User token usage               â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  /api/safeguard/               # SAFEGUARD (Phase 1 connection) â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ GET  /pending             # Pending approvals              â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ GET  /history             # Approval history               â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ POST /:id/approve         # Approve action                 â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ POST /:id/reject          # Reject action                  â”‚   â”‚
â”‚  â”‚  â””â”€â”€ WS   /ws                  # Real-time updates              â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  /api/supervision/             # Dashboards                     â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ GET  /overview            # Global KPIs                    â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ GET  /support             # SUPPORT dashboard              â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ GET  /sentinel            # SENTINEL dashboard             â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ GET  /enrichisseur        # ENRICHISSEUR dashboard         â”‚   â”‚
â”‚  â”‚  â””â”€â”€ WS   /ws                  # Real-time updates              â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  /api/users/                   # User management                â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ GET  /                    # List users                     â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ POST /                    # Create user                    â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ PUT  /:id                 # Update user                    â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ DELETE /:id               # Delete user                    â”‚   â”‚
â”‚  â”‚  â””â”€â”€ GET  /audit               # Audit log                      â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  /api/workflows/               # Phase 1 workflows (existant)   â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ POST /webhook/observium   # SENTINEL trigger               â”‚   â”‚
â”‚  â”‚  â””â”€â”€ GET  /health              # Health check                   â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                      SERVICES INTERNES                           â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  ChatService          # Gestion conversations + LLM             â”‚   â”‚
â”‚  â”‚  RAGService           # Recherche vectorielle (pgvector)        â”‚   â”‚
â”‚  â”‚  MCPClientService     # Appels directs au MCP Server            â”‚   â”‚
â”‚  â”‚  SafeguardService     # Connexion SAFEGUARD Phase 1             â”‚   â”‚
â”‚  â”‚  SupervisionService   # AgrÃ©gation mÃ©triques workflows          â”‚   â”‚
â”‚  â”‚  UserService          # CRUD utilisateurs + audit               â”‚   â”‚
â”‚  â”‚  AuthService          # JWT + bcrypt                            â”‚   â”‚
â”‚  â”‚  WebSocketManager     # Gestion connexions WS                   â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                      DATA LAYER                                  â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  PostgreSQL (existant)     Redis (existant)     MCP Server      â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ users                 â”œâ”€â”€ sessions         (Port 3001)     â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ conversations         â”œâ”€â”€ cache                            â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ messages              â””â”€â”€ websocket        Ollama/Mistral  â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ safeguard_approvals       pub/sub          (Embeddings)    â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ incident_logs                                              â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ widip_agent_logs                                           â”‚   â”‚
â”‚  â”‚  â””â”€â”€ user_audit_log (NEW)                                       â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 Frontend React (Ã‰volution du WIBOT existant)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FRONTEND REACT (Vite + TailwindCSS)                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  src/                                                                   â”‚
â”‚  â”œâ”€â”€ App.tsx                      # Router principal + menu            â”‚
â”‚  â”‚                                                                      â”‚
â”‚  â”œâ”€â”€ pages/                                                            â”‚
â”‚  â”‚   â”œâ”€â”€ Home.tsx                 # ğŸ†• Menu principal (sÃ©lection)      â”‚
â”‚  â”‚   â”œâ”€â”€ Chat.tsx                 # WIBOT (existant, adaptÃ©)           â”‚
â”‚  â”‚   â”œâ”€â”€ Safeguard.tsx            # SAFEGUARD (existant, amÃ©liorÃ©)     â”‚
â”‚  â”‚   â”œâ”€â”€ Supervision/             # ğŸ†• Dashboards                      â”‚
â”‚  â”‚   â”‚   â”œâ”€â”€ Overview.tsx         # Vue globale                        â”‚
â”‚  â”‚   â”‚   â”œâ”€â”€ SupportDashboard.tsx # SUPPORT metrics                    â”‚
â”‚  â”‚   â”‚   â”œâ”€â”€ SentinelDashboard.tsx# SENTINEL metrics                   â”‚
â”‚  â”‚   â”‚   â”œâ”€â”€ EnrichisseurDashboard.tsx                                 â”‚
â”‚  â”‚   â”‚   â””â”€â”€ SafeguardDashboard.tsx                                    â”‚
â”‚  â”‚   â”œâ”€â”€ Users.tsx                # Gestion utilisateurs               â”‚
â”‚  â”‚   â””â”€â”€ Login.tsx                # (existant)                         â”‚
â”‚  â”‚                                                                      â”‚
â”‚  â”œâ”€â”€ components/                                                       â”‚
â”‚  â”‚   â”œâ”€â”€ layout/                  # Header, Sidebar, Navigation       â”‚
â”‚  â”‚   â”œâ”€â”€ chat/                    # (existant)                         â”‚
â”‚  â”‚   â”œâ”€â”€ safeguard/               # (existant, amÃ©liorÃ©)               â”‚
â”‚  â”‚   â”œâ”€â”€ supervision/             # ğŸ†• Charts, KPIs, Tables            â”‚
â”‚  â”‚   â””â”€â”€ ui/                      # (existant)                         â”‚
â”‚  â”‚                                                                      â”‚
â”‚  â”œâ”€â”€ hooks/                                                            â”‚
â”‚  â”‚   â”œâ”€â”€ useChat.ts               # (existant)                         â”‚
â”‚  â”‚   â”œâ”€â”€ useSafeguard.ts          # (existant, + WebSocket)            â”‚
â”‚  â”‚   â”œâ”€â”€ useSupervision.ts        # ğŸ†• Dashboard data                  â”‚
â”‚  â”‚   â””â”€â”€ useWebSocket.ts          # ğŸ†• Real-time connection            â”‚
â”‚  â”‚                                                                      â”‚
â”‚  â””â”€â”€ services/                                                         â”‚
â”‚      â”œâ”€â”€ api.ts                   # (existant, adaptÃ©)                 â”‚
â”‚      â””â”€â”€ websocket.ts             # ğŸ†• WebSocket client                â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.3 Communication temps rÃ©el (WebSocket)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    WEBSOCKET ARCHITECTURE                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  Frontend                          Backend                              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€                          â”€â”€â”€â”€â”€â”€â”€                              â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Safeguard    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ /api/safeguard/ws                â”‚ â”‚
â”‚  â”‚ Component    â”‚   WebSocket     â”‚                                  â”‚ â”‚
â”‚  â”‚              â”‚                 â”‚ Events:                          â”‚ â”‚
â”‚  â”‚ â€¢ Badge countâ”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â€¢ safeguard:new_request          â”‚ â”‚
â”‚  â”‚ â€¢ List updateâ”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â€¢ safeguard:request_approved     â”‚ â”‚
â”‚  â”‚ â€¢ Timer sync â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â€¢ safeguard:request_rejected     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚ â€¢ safeguard:request_expired      â”‚ â”‚
â”‚                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Supervision  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ /api/supervision/ws              â”‚ â”‚
â”‚  â”‚ Dashboards   â”‚   WebSocket     â”‚                                  â”‚ â”‚
â”‚  â”‚              â”‚                 â”‚ Events:                          â”‚ â”‚
â”‚  â”‚ â€¢ KPIs       â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â€¢ workflow:ticket_processed      â”‚ â”‚
â”‚  â”‚ â€¢ Charts     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â€¢ workflow:alert_detected        â”‚ â”‚
â”‚  â”‚ â€¢ Alerts     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â€¢ workflow:error                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚ â€¢ workflow:health_change         â”‚ â”‚
â”‚                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                         â”‚
â”‚  Fallback: Polling toutes les 30s si WebSocket indisponible            â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. Modules Fonctionnels

### 3.1 WIBOT (Chat IA)

#### 3.1.1 Modes disponibles

| Mode | ModÃ¨le | Timeout | Description |
|------|--------|---------|-------------|
| **Flash** âš¡ | mistral-small | 30s | Questions rapides |
| **Code** ğŸ’» | codestral | 60s | Programmation, debug |
| **RÃ©daction** ğŸ“ | mistral-large | 90s | Textes longs, rapports |
| **Assistant WIDIP** ğŸ› ï¸ | mistral-large + MCP | **180s** | **Mode expert avec accÃ¨s MCP et RAG** |

#### 3.1.2 Mode Assistant WIDIP (nouveau)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MODE ASSISTANT WIDIP                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  Capabilities:                                                          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                          â”‚
â”‚  â€¢ AccÃ¨s direct au MCP Server (tous les outils L0-L2)                  â”‚
â”‚  â€¢ Recherche RAG intelligente (procÃ©dures, tickets, clients)           â”‚
â”‚  â€¢ Contexte WIDIP injectÃ© (alertes en cours, tickets rÃ©cents)          â”‚
â”‚  â€¢ Timeout Ã©tendu : 180 secondes                                        â”‚
â”‚                                                                         â”‚
â”‚  System Prompt:                                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                         â”‚
â”‚  """                                                                    â”‚
â”‚  Tu es l'Assistant WIDIP, un expert IT pour l'infogÃ©rance.             â”‚
â”‚  Tu as accÃ¨s aux outils suivants via MCP:                              â”‚
â”‚  - observium_get_device_status: Ã‰tat d'un Ã©quipement                   â”‚
â”‚  - observium_get_device_metrics: MÃ©triques rÃ©seau                      â”‚
â”‚  - glpi_get_ticket_details: DÃ©tails d'un ticket                        â”‚
â”‚  - glpi_search_client: Recherche client                                â”‚
â”‚  - memory_search_similar_cases: Recherche dans le RAG                  â”‚
â”‚  - ad_check_user: VÃ©rifier un compte AD                                â”‚
â”‚                                                                         â”‚
â”‚  Utilise ces outils pour rÃ©pondre aux questions techniques.            â”‚
â”‚  PrivilÃ©gie toujours les donnÃ©es rÃ©elles aux suppositions.             â”‚
â”‚  """                                                                    â”‚
â”‚                                                                         â”‚
â”‚  Exemple d'interaction:                                                 â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                 â”‚
â”‚  User: "Quel est l'Ã©tat du switch de la Clinique St-Jean ?"            â”‚
â”‚                                                                         â”‚
â”‚  Assistant:                                                             â”‚
â”‚  1. Appelle: glpi_search_client("Clinique St-Jean")                    â”‚
â”‚     â†’ RÃ©sultat: entity_id=42, nom="Clinique Saint-Jean"                â”‚
â”‚                                                                         â”‚
â”‚  2. Appelle: observium_get_device_status("SWITCH-CLIN-STJEAN")         â”‚
â”‚     â†’ RÃ©sultat: status=UP, uptime=45 jours, ports=24/24                â”‚
â”‚                                                                         â”‚
â”‚  3. Appelle: memory_search_similar_cases("Clinique St-Jean switch")    â”‚
â”‚     â†’ RÃ©sultat: 2 incidents rÃ©solus en 2024                            â”‚
â”‚                                                                         â”‚
â”‚  4. RÃ©pond:                                                             â”‚
â”‚     "Le switch SWITCH-CLIN-STJEAN de la Clinique Saint-Jean est        â”‚
â”‚      opÃ©rationnel (UP) depuis 45 jours. Tous les 24 ports sont         â”‚
â”‚      actifs. 2 incidents ont Ã©tÃ© rÃ©solus sur cet Ã©quipement en 2024."  â”‚
â”‚                                                                         â”‚
â”‚  Restrictions:                                                          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                          â”‚
â”‚  â€¢ Pas d'actions L3+ (reset password, close ticket) â†’ SAFEGUARD        â”‚
â”‚  â€¢ Actions L2 loguÃ©es dans user_audit_log                              â”‚
â”‚  â€¢ Timeout strict 180s avec message d'erreur gracieux                  â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.1.3 RAG UnifiÃ©

```
Le RAG est partagÃ© avec Phase 1:
- MÃªme base pgvector (widip_knowledge_base)
- Enrichi quotidiennement par ENRICHISSEUR
- Sources: procÃ©dures, tickets rÃ©solus, documentation clients

Flux:
1. User pose question
2. Backend gÃ©nÃ¨re embedding (Ollama)
3. Recherche top-5 chunks similaires
4. Injection dans le prompt
5. LLM gÃ©nÃ¨re rÃ©ponse contextualisÃ©e
```

### 3.2 SAFEGUARD (Approbations)

#### 3.2.1 Connexion avec Phase 1

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SAFEGUARD INTEGRATION                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  Phase 1 Workflows                    Phase 2 Frontend                  â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                  â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚ SUPPORT Workflow â”‚                â”‚ Safeguard Page   â”‚              â”‚
â”‚  â”‚                  â”‚                â”‚                  â”‚              â”‚
â”‚  â”‚ Action L3 needed â”‚                â”‚ â€¢ Pending list   â”‚              â”‚
â”‚  â”‚ (ad_reset_pwd)   â”‚                â”‚ â€¢ Approve/Reject â”‚              â”‚
â”‚  â”‚       â”‚          â”‚                â”‚ â€¢ Context viewer â”‚              â”‚
â”‚  â”‚       â–¼          â”‚                â”‚       â–²          â”‚              â”‚
â”‚  â”‚ SafeguardService â”‚â”€â”€â”€â”€ Redis â”€â”€â”€â”€â–ºâ”‚ WebSocket update â”‚              â”‚
â”‚  â”‚ create_request() â”‚   pub/sub      â”‚                  â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                                                         â”‚
â”‚  DonnÃ©es incluses dans la demande:                                     â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                     â”‚
â”‚  {                                                                      â”‚
â”‚    "approval_id": "APR-2026-001",                                      â”‚
â”‚    "tool_name": "ad_reset_password",                                   â”‚
â”‚    "arguments": {"username": "jean.dupont"},                           â”‚
â”‚    "security_level": "L3",                                             â”‚
â”‚    "context": {                                                        â”‚
â”‚      "ticket_id": 1234,                                                â”‚
â”‚      "ticket_title": "Reset MDP - Jean Dupont",                        â”‚
â”‚      "ticket_description": "Demande reset mot de passe...",            â”‚
â”‚      "client_name": "EHPAD Les Jardins",                               â”‚
â”‚      "workflow": "SUPPORT",                                            â”‚
â”‚      "confidence": 95                                                  â”‚
â”‚    },                                                                   â”‚
â”‚    "expires_at": "2026-01-06T15:30:00Z"                                â”‚
â”‚  }                                                                      â”‚
â”‚                                                                         â”‚
â”‚  Le contexte ticket permet au technicien de comprendre                 â”‚
â”‚  POURQUOI l'action est demandÃ©e avant d'approuver.                     â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.2.2 Interface amÃ©liorÃ©e

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ›¡ï¸ SAFEGUARD - Approbations en attente (3)                      [ğŸ”” 3] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ”´ URGENT - Expire dans 12 min                                  â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚ Action: ad_reset_password                                       â”‚   â”‚
â”‚  â”‚ Utilisateur: jean.dupont                                        â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚ â”Œâ”€ Contexte Ticket #1234 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚ â”‚ Client: EHPAD Les Jardins                                   â”‚ â”‚   â”‚
â”‚  â”‚ â”‚ Titre: Reset MDP - Jean Dupont                              â”‚ â”‚   â”‚
â”‚  â”‚ â”‚ Description: L'utilisateur a oubliÃ© son mot de passe...     â”‚ â”‚   â”‚
â”‚  â”‚ â”‚ Workflow: SUPPORT (confiance: 95%)                          â”‚ â”‚   â”‚
â”‚  â”‚ â”‚ [ğŸ”— Voir ticket GLPI]                                       â”‚ â”‚   â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚ [âœ… APPROUVER]  [âŒ REJETER]  [â¸ï¸ REPORTER]                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸŸ¡ Expire dans 45 min                                           â”‚   â”‚
â”‚  â”‚ Action: glpi_close_ticket                                       â”‚   â”‚
â”‚  â”‚ Ticket: #5678                                                   â”‚   â”‚
â”‚  â”‚ ...                                                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3 SUPERVISION (Dashboards)

#### 3.3.1 Vue Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“Š SUPERVISION - Overview                                    [ğŸ”„ Live] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ Tickets/24h â”‚ â”‚ Alertes/24h â”‚ â”‚ Approbationsâ”‚ â”‚ RAG Entries â”‚       â”‚
â”‚  â”‚    127      â”‚ â”‚     23      â”‚ â”‚  â³ 3 pendingâ”‚ â”‚   52,340    â”‚       â”‚
â”‚  â”‚   â†‘ 12%     â”‚ â”‚   â†“ 5%      â”‚ â”‚             â”‚ â”‚   +48 today â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€ Health Status â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ğŸŸ¢ GLPI: OK    ğŸŸ¢ Redis: OK    ğŸŸ¢ Observium: OK    ğŸŸ¢ MCP: OK   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€ ActivitÃ© temps rÃ©el â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                                                   â”‚  â”‚
â”‚  â”‚  14:32:15  ğŸ« SUPPORT traitÃ© ticket #1234 (RESET_MDP)            â”‚  â”‚
â”‚  â”‚  14:31:02  ğŸ”” SENTINEL alerte: SWITCH-CLI-001 DOWN               â”‚  â”‚
â”‚  â”‚  14:30:45  âœ… SAFEGUARD approuvÃ©: ad_reset_password              â”‚  â”‚
â”‚  â”‚  14:28:12  ğŸ« SUPPORT traitÃ© ticket #1233 (DEBLOCAGE)            â”‚  â”‚
â”‚  â”‚  ...                                                              â”‚  â”‚
â”‚  â”‚                                                                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€ Navigation Dashboards â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  [SUPPORT] [SENTINEL] [ENRICHISSEUR] [SAFEGUARD Stats]           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.3.2 Dashboard SUPPORT

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“Š SUPERVISION > SUPPORT Dashboard                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â”Œâ”€ Tickets traitÃ©s aujourd'hui â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                                                   â”‚  â”‚
â”‚  â”‚   [====================] 127 tickets                              â”‚  â”‚
â”‚  â”‚                                                                   â”‚  â”‚
â”‚  â”‚   Par catÃ©gorie:                                                  â”‚  â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚  â”‚
â”‚  â”‚   â”‚ CatÃ©gorie      â”‚ Count  â”‚ Auto-res â”‚                         â”‚  â”‚
â”‚  â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                         â”‚  â”‚
â”‚  â”‚   â”‚ RESET_MDP      â”‚ 45     â”‚ 98%      â”‚                         â”‚  â”‚
â”‚  â”‚   â”‚ DEBLOCAGE      â”‚ 32     â”‚ 100%     â”‚                         â”‚  â”‚
â”‚  â”‚   â”‚ #DIAG          â”‚ 28     â”‚ N/A      â”‚                         â”‚  â”‚
â”‚  â”‚   â”‚ AUTRE          â”‚ 22     â”‚ 0%       â”‚                         â”‚  â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚  â”‚
â”‚  â”‚                                                                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€ DerniÃ¨res actions â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                                                   â”‚  â”‚
â”‚  â”‚  14:32  #1234  RESET_MDP   âœ… RÃ©solu    Client: EHPAD Les Jar..  â”‚  â”‚
â”‚  â”‚  14:28  #1233  DEBLOCAGE   âœ… RÃ©solu    Client: Clinique St-J..  â”‚  â”‚
â”‚  â”‚  14:15  #1232  #DIAG       â³ En cours  Client: EHPAD Music..    â”‚  â”‚
â”‚  â”‚  14:10  #1231  AUTRE       â†—ï¸ EscaladÃ©  Client: Cabinet Dr...    â”‚  â”‚
â”‚  â”‚                                                                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€ Erreurs (2 derniÃ¨res 24h) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                                                   â”‚  â”‚
â”‚  â”‚  âš ï¸ 13:45 - Timeout MCP (ad_reset_password) - Ticket #1230       â”‚  â”‚
â”‚  â”‚  âŒ 09:12 - GLPI API Error 500 - Retry rÃ©ussi aprÃ¨s 3 tentatives â”‚  â”‚
â”‚  â”‚                                                                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.3.3 Dashboard SENTINEL

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“Š SUPERVISION > SENTINEL Dashboard                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â”Œâ”€ Alertes aujourd'hui â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                                                   â”‚  â”‚
â”‚  â”‚   Total: 23 alertes   |   En cours: 2   |   RÃ©solues: 21         â”‚  â”‚
â”‚  â”‚                                                                   â”‚  â”‚
â”‚  â”‚   ResponsabilitÃ© breakdown:                                       â”‚  â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚  â”‚
â”‚  â”‚   â”‚  FAI        â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  45%          â”‚                     â”‚  â”‚
â”‚  â”‚   â”‚  Local      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ       25%           â”‚                     â”‚  â”‚
â”‚  â”‚   â”‚  WIDIP      â–ˆâ–ˆâ–ˆâ–ˆ         15%           â”‚                     â”‚  â”‚
â”‚  â”‚   â”‚  IndÃ©terminÃ© â–ˆâ–ˆâ–ˆ         15%           â”‚                     â”‚  â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚  â”‚
â”‚  â”‚                                                                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€ Clients impactÃ©s â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                                                   â”‚  â”‚
â”‚  â”‚  ğŸ”´ EHPAD Music Art        2 alertes actives  (FAI depuis 45min) â”‚  â”‚
â”‚  â”‚  ğŸŸ¡ Clinique St-Joseph     1 alerte #DIAG     (attente diag)     â”‚  â”‚
â”‚  â”‚  ğŸŸ¢ Cabinet Dr Martin      RÃ©solu il y a 2h   (Ã©tait Local)      â”‚  â”‚
â”‚  â”‚  ğŸŸ¢ EHPAD Les Jardins      RÃ©solu il y a 4h   (Ã©tait FAI)        â”‚  â”‚
â”‚  â”‚                                                                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€ Timeline alertes â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                                                   â”‚  â”‚
â”‚  â”‚  14:30 â”€â—â”€ SWITCH-MUSIC-001 DOWN (FAI probable, 75%)             â”‚  â”‚
â”‚  â”‚         â”‚  â†’ Ticket #4567 crÃ©Ã©                                   â”‚  â”‚
â”‚  â”‚         â”‚  â†’ Email diagnostic envoyÃ© au client                   â”‚  â”‚
â”‚  â”‚         â”‚  â†’ â³ En attente rÃ©ponse #DIAG                         â”‚  â”‚
â”‚  â”‚  13:15 â”€â—â”€ SWITCH-CLIN-002 DOWN (Local, 90%)                     â”‚  â”‚
â”‚  â”‚         â”‚  â†’ Ticket #4566 crÃ©Ã©                                   â”‚  â”‚
â”‚  â”‚         â””â”€ âœ… RÃ©solu Ã  13:45 (client a reboot Ã©quipement)        â”‚  â”‚
â”‚  â”‚                                                                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.3.4 Dashboard SAFEGUARD Stats

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“Š SUPERVISION > SAFEGUARD Analytics                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â”Œâ”€ Approbations en attente â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                                                   â”‚  â”‚
â”‚  â”‚  â³ 3 demandes en attente                                         â”‚  â”‚
â”‚  â”‚                                                                   â”‚  â”‚
â”‚  â”‚  ğŸ”´ APR-001  ad_reset_password    Expire dans 12 min             â”‚  â”‚
â”‚  â”‚  ğŸŸ¡ APR-002  glpi_close_ticket    Expire dans 45 min             â”‚  â”‚
â”‚  â”‚  ğŸŸ¢ APR-003  ad_disable_account   Expire dans 58 min             â”‚  â”‚
â”‚  â”‚                                                                   â”‚  â”‚
â”‚  â”‚  [Aller au SAFEGUARD â†’]                                          â”‚  â”‚
â”‚  â”‚                                                                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€ Statistiques 7 derniers jours â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                                                   â”‚  â”‚
â”‚  â”‚   Total demandes: 156                                             â”‚  â”‚
â”‚  â”‚   âœ… ApprouvÃ©es: 142 (91%)                                        â”‚  â”‚
â”‚  â”‚   âŒ RejetÃ©es: 8 (5%)                                             â”‚  â”‚
â”‚  â”‚   â° ExpirÃ©es: 6 (4%)                                             â”‚  â”‚
â”‚  â”‚                                                                   â”‚  â”‚
â”‚  â”‚   Temps moyen de rÃ©ponse: 8 min 32 sec                           â”‚  â”‚
â”‚  â”‚                                                                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€ Top actions demandÃ©es â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                                                   â”‚  â”‚
â”‚  â”‚   1. ad_reset_password      89 (57%)                             â”‚  â”‚
â”‚  â”‚   2. glpi_close_ticket      45 (29%)                             â”‚  â”‚
â”‚  â”‚   3. ad_disable_account     15 (10%)                             â”‚  â”‚
â”‚  â”‚   4. ad_copy_groups_from     7 (4%)                              â”‚  â”‚
â”‚  â”‚                                                                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.4 USERS (Gestion utilisateurs)

#### 3.4.1 FonctionnalitÃ©s

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ‘¥ UTILISATEURS                                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â”Œâ”€ Liste utilisateurs â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                                                   â”‚  â”‚
â”‚  â”‚  [+ Nouvel utilisateur]  [ğŸ” Rechercher...]                      â”‚  â”‚
â”‚  â”‚                                                                   â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚  â”‚
â”‚  â”‚  â”‚ Username  â”‚ Role   â”‚ Niveau â”‚ Tokens    â”‚ DerniÃ¨re connexion â”‚â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚  â”‚
â”‚  â”‚  â”‚ khora     â”‚ admin  â”‚ N4     â”‚ 45k/50k   â”‚ Aujourd'hui 14:30  â”‚â”‚  â”‚
â”‚  â”‚  â”‚ jdupont   â”‚ tech   â”‚ N2     â”‚ 12k/30k   â”‚ Hier 18:45         â”‚â”‚  â”‚
â”‚  â”‚  â”‚ mmartin   â”‚ tech   â”‚ N1     â”‚ 8k/30k    â”‚ Il y a 3 jours     â”‚â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚  â”‚
â”‚  â”‚                                                                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€ Niveaux d'accrÃ©ditation â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                                                   â”‚  â”‚
â”‚  â”‚  N0 : Lecture seule (WIBOT chat uniquement)                      â”‚  â”‚
â”‚  â”‚  N1 : Technicien (actions L1, SAFEGUARD read)                    â”‚  â”‚
â”‚  â”‚  N2 : Technicien Senior (actions L1-L2, SAFEGUARD approve)       â”‚  â”‚
â”‚  â”‚  N3 : Admin (actions L1-L3, SAFEGUARD all, Supervision)          â”‚  â”‚
â”‚  â”‚  N4 : Super Admin (tout, gestion utilisateurs)                   â”‚  â”‚
â”‚  â”‚                                                                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.4.2 Audit Log

```sql
-- Table user_audit_log
CREATE TABLE user_audit_log (
    id SERIAL PRIMARY KEY,
    user_id INT REFERENCES users(id),
    action VARCHAR(100) NOT NULL,      -- 'login', 'safeguard_approve', etc.
    target_type VARCHAR(50),           -- 'safeguard', 'user', 'conversation'
    target_id VARCHAR(100),            -- ID de la ressource
    details JSONB,                     -- DÃ©tails supplÃ©mentaires
    ip_address VARCHAR(45),
    user_agent TEXT,
    created_at TIMESTAMP DEFAULT NOW()
);

-- Index pour requÃªtes frÃ©quentes
CREATE INDEX idx_audit_user ON user_audit_log(user_id);
CREATE INDEX idx_audit_action ON user_audit_log(action);
CREATE INDEX idx_audit_created ON user_audit_log(created_at DESC);
```

---

## 4. SpÃ©cifications Techniques

### 4.1 Stack Technique

| Composant | Technologie | Version |
|-----------|-------------|---------|
| **Backend** | FastAPI | 0.109+ |
| **ORM** | SQLAlchemy | 2.0+ |
| **Async DB** | asyncpg | 0.29+ |
| **Cache** | Redis | 5.0+ |
| **WebSocket** | FastAPI WebSocket | Native |
| **Auth** | JWT + bcrypt | python-jose, bcrypt |
| **Frontend** | React | 18.2+ |
| **State** | Zustand | 5.0+ |
| **Styling** | TailwindCSS | 3.4+ |
| **Charts** | Recharts | 2.10+ |
| **HTTP** | Axios | 1.6+ |
| **Build** | Vite | 5.0+ |

### 4.2 Nouvelles dÃ©pendances Python

```toml
# pyproject.toml - Ajouts Phase 2

[project.dependencies]
# Auth
python-jose = "^3.3.0"
bcrypt = "^4.1.0"

# WebSocket
websockets = "^12.0"

# LLM
langchain = "^0.1.0"
langchain-community = "^0.0.10"

# Streaming SSE
sse-starlette = "^1.8.0"

# Metrics (optionnel pour Prometheus)
prometheus-fastapi-instrumentator = "^6.1.0"
```

### 4.3 SchÃ©ma Base de DonnÃ©es (Additions)

```sql
-- Nouvelles tables Phase 2

-- Conversations WIBOT (migration depuis n8n)
CREATE TABLE conversations (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id INT REFERENCES users(id) ON DELETE CASCADE,
    title VARCHAR(255),
    mode VARCHAR(50) DEFAULT 'flash',  -- flash, code, redaction, assistant
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);

-- Messages WIBOT
CREATE TABLE messages (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    conversation_id UUID REFERENCES conversations(id) ON DELETE CASCADE,
    role VARCHAR(20) NOT NULL,  -- 'user' ou 'assistant'
    content TEXT NOT NULL,
    tokens_used INT DEFAULT 0,
    mode VARCHAR(50),
    rag_used BOOLEAN DEFAULT FALSE,
    mcp_tools_used JSONB,  -- Liste des outils MCP appelÃ©s
    created_at TIMESTAMP DEFAULT NOW()
);

-- AmÃ©lioration table users (bcrypt)
ALTER TABLE users
    ALTER COLUMN password TYPE VARCHAR(255);  -- Pour hash bcrypt

-- Audit log
CREATE TABLE user_audit_log (
    id SERIAL PRIMARY KEY,
    user_id INT REFERENCES users(id),
    action VARCHAR(100) NOT NULL,
    target_type VARCHAR(50),
    target_id VARCHAR(100),
    details JSONB,
    ip_address VARCHAR(45),
    user_agent TEXT,
    created_at TIMESTAMP DEFAULT NOW()
);

-- Index performances
CREATE INDEX idx_conversations_user ON conversations(user_id);
CREATE INDEX idx_messages_conversation ON messages(conversation_id);
CREATE INDEX idx_messages_created ON messages(created_at DESC);
CREATE INDEX idx_audit_user ON user_audit_log(user_id);
CREATE INDEX idx_audit_created ON user_audit_log(created_at DESC);
```

---

## 5. Structure du Projet

### 5.1 Backend Python (unifiÃ© avec Phase 1)

```
widip-mcp-server/
â”œâ”€â”€ src/                            # MCP Server (Phase 1, inchangÃ©)
â”‚   â”œâ”€â”€ main.py
â”‚   â”œâ”€â”€ config.py
â”‚   â”œâ”€â”€ clients/
â”‚   â”œâ”€â”€ tools/
â”‚   â”œâ”€â”€ mcp/
â”‚   â””â”€â”€ utils/
â”‚
â”œâ”€â”€ workflows/                      # Workflows Python (Phase 1)
â”‚   â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ sentinel/
â”‚   â”œâ”€â”€ support/
â”‚   â”œâ”€â”€ enrichisseur/
â”‚   â”œâ”€â”€ safeguard/
â”‚   â””â”€â”€ health_check/
â”‚
â”œâ”€â”€ api/                            # ğŸ†• API Phase 2 (WIBOT, Dashboard)
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ main.py                     # FastAPI app unifiÃ©
â”‚   â”œâ”€â”€ config.py                   # Config Phase 2
â”‚   â”‚
â”‚   â”œâ”€â”€ auth/                       # Authentification
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ routes.py               # /api/auth/*
â”‚   â”‚   â”œâ”€â”€ service.py              # JWT, bcrypt
â”‚   â”‚   â”œâ”€â”€ models.py               # User model
â”‚   â”‚   â””â”€â”€ dependencies.py         # get_current_user
â”‚   â”‚
â”‚   â”œâ”€â”€ chat/                       # WIBOT Chat
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ routes.py               # /api/chat/*
â”‚   â”‚   â”œâ”€â”€ service.py              # ChatService
â”‚   â”‚   â”œâ”€â”€ llm.py                  # LLM integration
â”‚   â”‚   â”œâ”€â”€ rag.py                  # RAG search
â”‚   â”‚   â”œâ”€â”€ mcp_client.py           # MCP tool calls
â”‚   â”‚   â””â”€â”€ streaming.py            # SSE streaming
â”‚   â”‚
â”‚   â”œâ”€â”€ safeguard/                  # SAFEGUARD UI
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ routes.py               # /api/safeguard/*
â”‚   â”‚   â”œâ”€â”€ service.py              # Connect to Phase 1
â”‚   â”‚   â””â”€â”€ websocket.py            # Real-time updates
â”‚   â”‚
â”‚   â”œâ”€â”€ supervision/                # Dashboards
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ routes.py               # /api/supervision/*
â”‚   â”‚   â”œâ”€â”€ service.py              # Metrics aggregation
â”‚   â”‚   â”œâ”€â”€ overview.py             # Overview data
â”‚   â”‚   â”œâ”€â”€ support.py              # SUPPORT metrics
â”‚   â”‚   â”œâ”€â”€ sentinel.py             # SENTINEL metrics
â”‚   â”‚   â””â”€â”€ websocket.py            # Real-time updates
â”‚   â”‚
â”‚   â”œâ”€â”€ users/                      # User management
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ routes.py               # /api/users/*
â”‚   â”‚   â”œâ”€â”€ service.py              # CRUD
â”‚   â”‚   â””â”€â”€ audit.py                # Audit logging
â”‚   â”‚
â”‚   â””â”€â”€ websocket/                  # WebSocket manager
â”‚       â”œâ”€â”€ __init__.py
â”‚       â””â”€â”€ manager.py              # Connection management
â”‚
â”œâ”€â”€ runner.py                       # Point d'entrÃ©e unifiÃ©
â”œâ”€â”€ tests/
â”œâ”€â”€ docker-compose.yml
â””â”€â”€ pyproject.toml
```

### 5.2 Frontend React (Ã©volution WIBOT)

```
wibot-frontend/                     # RÃ©pertoire existant, Ã©volution
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ App.tsx                     # ğŸ”„ Router + menu principal
â”‚   â”‚
â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”œâ”€â”€ Home.tsx                # ğŸ†• Menu sÃ©lection (WIBOT/SAFEGUARD/...)
â”‚   â”‚   â”œâ”€â”€ Chat.tsx                # (existant, adaptÃ©)
â”‚   â”‚   â”œâ”€â”€ Safeguard.tsx           # (existant, amÃ©liorÃ© WebSocket)
â”‚   â”‚   â”œâ”€â”€ Login.tsx               # (existant)
â”‚   â”‚   â”œâ”€â”€ Users.tsx               # ğŸ”„ (existant AdminUsers, renommÃ©)
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ Supervision/            # ğŸ†• Nouveau dossier
â”‚   â”‚       â”œâ”€â”€ index.tsx           # Layout supervision
â”‚   â”‚       â”œâ”€â”€ Overview.tsx        # Vue globale
â”‚   â”‚       â”œâ”€â”€ SupportDashboard.tsx
â”‚   â”‚       â”œâ”€â”€ SentinelDashboard.tsx
â”‚   â”‚       â”œâ”€â”€ EnrichisseurDashboard.tsx
â”‚   â”‚       â””â”€â”€ SafeguardDashboard.tsx
â”‚   â”‚
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ layout/
â”‚   â”‚   â”‚   â”œâ”€â”€ MainMenu.tsx        # ğŸ†• Menu principal (sÃ©lection module)
â”‚   â”‚   â”‚   â”œâ”€â”€ Header.tsx          # (existant, adaptÃ©)
â”‚   â”‚   â”‚   â””â”€â”€ Sidebar.tsx         # (existant)
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ chat/                   # (existant)
â”‚   â”‚   â”‚   â”œâ”€â”€ ChatWindow.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Message.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ ModeSelector.tsx    # ğŸ”„ + mode Assistant WIDIP
â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ safeguard/              # (existant, amÃ©liorÃ©)
â”‚   â”‚   â”‚   â”œâ”€â”€ RequestList.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ RequestDetail.tsx   # ğŸ”„ + contexte ticket
â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ supervision/            # ğŸ†• Nouveau
â”‚   â”‚   â”‚   â”œâ”€â”€ KPICard.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ ActivityFeed.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ HealthStatus.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ TicketTable.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ AlertTimeline.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ ResponsibilityChart.tsx
â”‚   â”‚   â”‚   â””â”€â”€ ClientImpactList.tsx
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ ui/                     # (existant)
â”‚   â”‚
â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â”œâ”€â”€ useAuth.ts              # (existant)
â”‚   â”‚   â”œâ”€â”€ useChat.ts              # (existant)
â”‚   â”‚   â”œâ”€â”€ useSafeguard.ts         # ğŸ”„ + WebSocket
â”‚   â”‚   â”œâ”€â”€ useSupervision.ts       # ğŸ†•
â”‚   â”‚   â””â”€â”€ useWebSocket.ts         # ğŸ†•
â”‚   â”‚
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ api.ts                  # ğŸ”„ (adaptÃ© nouvelles routes)
â”‚   â”‚   â””â”€â”€ websocket.ts            # ğŸ†•
â”‚   â”‚
â”‚   â””â”€â”€ store/
â”‚       â”œâ”€â”€ index.ts                # (existant)
â”‚       â”œâ”€â”€ safeguardStore.ts       # (existant)
â”‚       â””â”€â”€ supervisionStore.ts     # ğŸ†•
â”‚
â”œâ”€â”€ package.json
â””â”€â”€ vite.config.ts
```

---

## 6. SÃ©curitÃ©

### 6.1 AmÃ©liorations obligatoires

| ProblÃ¨me actuel | Solution Phase 2 |
|-----------------|------------------|
| Passwords en clair | **bcrypt** avec salt (cost=12) |
| JWT secret visible | **.env** file + Docker secrets |
| Pas de rate limiting | **slowapi** (100 req/min/user) |
| CORS permissif | **Whitelist explicite** |
| Pas d'audit | **user_audit_log** table |

### 6.2 ImplÃ©mentation bcrypt

```python
# api/auth/service.py
from bcrypt import hashpw, checkpw, gensalt

class AuthService:
    BCRYPT_COST = 12

    def hash_password(self, password: str) -> str:
        """Hash password with bcrypt"""
        return hashpw(
            password.encode('utf-8'),
            gensalt(rounds=self.BCRYPT_COST)
        ).decode('utf-8')

    def verify_password(self, password: str, hashed: str) -> bool:
        """Verify password against hash"""
        return checkpw(
            password.encode('utf-8'),
            hashed.encode('utf-8')
        )
```

### 6.3 JWT Configuration

```python
# api/auth/service.py
from jose import jwt
from datetime import datetime, timedelta

class JWTService:
    ALGORITHM = "HS256"
    ACCESS_TOKEN_EXPIRE_HOURS = 8

    def create_token(self, user_id: int, username: str, role: str, level: str) -> str:
        expire = datetime.utcnow() + timedelta(hours=self.ACCESS_TOKEN_EXPIRE_HOURS)
        payload = {
            "sub": str(user_id),
            "username": username,
            "role": role,
            "accreditation_level": level,
            "exp": expire
        }
        return jwt.encode(payload, settings.jwt_secret, algorithm=self.ALGORITHM)
```

### 6.4 Rate Limiting

```python
# api/main.py
from slowapi import Limiter
from slowapi.util import get_remote_address

limiter = Limiter(key_func=get_remote_address)
app.state.limiter = limiter

@app.post("/api/auth/login")
@limiter.limit("5/minute")  # Protection brute force
async def login(request: Request, credentials: LoginRequest):
    ...

@app.post("/api/chat/message")
@limiter.limit("30/minute")  # Limite chat
async def send_message(request: Request, ...):
    ...
```

---

## 7. Plan de Migration

### 7.1 StratÃ©gie globale

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    STRATÃ‰GIE MIGRATION PHASE 2                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  Approche: Migration progressive avec cohabitation                     â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚  n8n WIBOT  â”‚     â”‚   HYBRID    â”‚     â”‚   PYTHON    â”‚              â”‚
â”‚  â”‚  (actuel)   â”‚ â”€â”€â–º â”‚  (n8n+Py)   â”‚ â”€â”€â–º â”‚   ONLY      â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                                                         â”‚
â”‚  Phase 2.0: Backend Python + n8n RAG (cohabitation)                    â”‚
â”‚  Phase 2.1: WIBOT migrÃ©, frontend adaptÃ©                               â”‚
â”‚  Phase 2.2-2.4: Nouvelles features                                     â”‚
â”‚  Phase 2.5: Suppression n8n WIBOT (garde RAG uniquement)               â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2 Docker Compose unifiÃ©

```yaml
# docker-compose.yml (Phase 2)
version: '3.8'

services:
  # Base de donnÃ©es
  postgres:
    image: pgvector/pgvector:pg16
    volumes:
      - postgres_data:/var/lib/postgresql/data
      - ./init.sql:/docker-entrypoint-initdb.d/init.sql
    environment:
      POSTGRES_DB: widip
      POSTGRES_USER: ${DB_USER}
      POSTGRES_PASSWORD: ${DB_PASSWORD}
    ports:
      - "5432:5432"

  # Cache
  redis:
    image: redis:7-alpine
    volumes:
      - redis_data:/data
    ports:
      - "6379:6379"

  # MCP Server (Phase 1, inchangÃ©)
  mcp-server:
    build: ./widip-mcp-server
    ports:
      - "3001:3001"
    environment:
      - DATABASE_URL=postgresql://${DB_USER}:${DB_PASSWORD}@postgres:5432/widip
      - REDIS_URL=redis://redis:6379
    depends_on:
      - postgres
      - redis

  # Backend UnifiÃ© (Phase 1 workflows + Phase 2 API)
  widip-backend:
    build:
      context: ./widip-mcp-server
      dockerfile: Dockerfile.unified
    ports:
      - "3002:3002"
    environment:
      - DATABASE_URL=postgresql://${DB_USER}:${DB_PASSWORD}@postgres:5432/widip
      - REDIS_URL=redis://redis:6379
      - MCP_SERVER_URL=http://mcp-server:3001
      - JWT_SECRET=${JWT_SECRET}
      - OLLAMA_BASE_URL=http://ollama:11434
    depends_on:
      - postgres
      - redis
      - mcp-server

  # n8n (uniquement pour RAG ingestion)
  n8n:
    image: n8nio/n8n:latest
    ports:
      - "5678:5678"
    volumes:
      - n8n_data:/home/node/.n8n
      - ./rag-documents:/data/rag-documents
    environment:
      - DB_TYPE=postgresdb
      - DB_POSTGRESDB_HOST=postgres
      - DB_POSTGRESDB_DATABASE=widip
    depends_on:
      - postgres

  # Ollama (LLM local)
  ollama:
    image: ollama/ollama:latest
    volumes:
      - ollama_data:/root/.ollama
    ports:
      - "11434:11434"

  # Frontend (static build served by nginx)
  frontend:
    build: ./wibot-frontend
    ports:
      - "8080:80"
    depends_on:
      - widip-backend

  # Nginx (reverse proxy)
  nginx:
    image: nginx:alpine
    ports:
      - "443:443"
      - "80:80"
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf
      - ./certs:/etc/nginx/certs
    depends_on:
      - frontend
      - widip-backend

volumes:
  postgres_data:
  redis_data:
  n8n_data:
  ollama_data:
```

---

## 8. Roadmap DÃ©taillÃ©e

### 8.1 Vue calendaire

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ROADMAP PHASE 2                                 â”‚
â”‚                         (~9 semaines)                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  PHASE 2.0 : Fondations (2 semaines)                                   â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                   â”‚
â”‚                                                                         â”‚
â”‚  Semaine 1:                                                            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                            â”‚
â”‚  â–¡ Jour 1-2: Setup structure api/                                      â”‚
â”‚    â€¢ FastAPI app avec routers                                          â”‚
â”‚    â€¢ Config Pydantic (JWT, DB, Redis)                                  â”‚
â”‚    â€¢ IntÃ©gration avec runner.py existant                               â”‚
â”‚                                                                         â”‚
â”‚  â–¡ Jour 3-4: Auth module                                               â”‚
â”‚    â€¢ bcrypt password hashing                                           â”‚
â”‚    â€¢ JWT creation/validation                                           â”‚
â”‚    â€¢ Migration passwords existants                                     â”‚
â”‚                                                                         â”‚
â”‚  â–¡ Jour 5: Tests auth + dÃ©ploiement                                    â”‚
â”‚    â€¢ Tests unitaires auth                                              â”‚
â”‚    â€¢ Docker compose mis Ã  jour                                         â”‚
â”‚                                                                         â”‚
â”‚  Semaine 2:                                                            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                            â”‚
â”‚  â–¡ Jour 1-2: WebSocket infrastructure                                  â”‚
â”‚    â€¢ WebSocketManager class                                            â”‚
â”‚    â€¢ Redis pub/sub integration                                         â”‚
â”‚    â€¢ Connection management                                             â”‚
â”‚                                                                         â”‚
â”‚  â–¡ Jour 3-4: Database migrations                                       â”‚
â”‚    â€¢ Nouvelles tables (conversations, messages, audit)                 â”‚
â”‚    â€¢ Index performances                                                â”‚
â”‚    â€¢ Migration donnÃ©es existantes                                      â”‚
â”‚                                                                         â”‚
â”‚  â–¡ Jour 5: Tests intÃ©gration                                           â”‚
â”‚    â€¢ WebSocket tests                                                   â”‚
â”‚    â€¢ DB tests                                                          â”‚
â”‚                                                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                         â”‚
â”‚  PHASE 2.1 : WIBOT Core (2 semaines)                                   â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                   â”‚
â”‚                                                                         â”‚
â”‚  Semaine 3:                                                            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                            â”‚
â”‚  â–¡ Jour 1-2: Chat service                                              â”‚
â”‚    â€¢ Conversations CRUD                                                â”‚
â”‚    â€¢ Messages CRUD                                                     â”‚
â”‚    â€¢ Token counting                                                    â”‚
â”‚                                                                         â”‚
â”‚  â–¡ Jour 3-4: LLM integration                                           â”‚
â”‚    â€¢ Ollama/Mistral client                                             â”‚
â”‚    â€¢ Modes: Flash, Code, RÃ©daction                                     â”‚
â”‚    â€¢ Streaming SSE                                                     â”‚
â”‚                                                                         â”‚
â”‚  â–¡ Jour 5: RAG integration                                             â”‚
â”‚    â€¢ Connexion pgvector existant                                       â”‚
â”‚    â€¢ Search similar cases                                              â”‚
â”‚    â€¢ Context injection                                                 â”‚
â”‚                                                                         â”‚
â”‚  Semaine 4:                                                            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                            â”‚
â”‚  â–¡ Jour 1-2: Mode Assistant WIDIP                                      â”‚
â”‚    â€¢ MCP client (appels directs)                                       â”‚
â”‚    â€¢ System prompt spÃ©cialisÃ©                                          â”‚
â”‚    â€¢ Timeout 180s                                                      â”‚
â”‚    â€¢ Tool calling logic                                                â”‚
â”‚                                                                         â”‚
â”‚  â–¡ Jour 3-4: Frontend adaptation                                       â”‚
â”‚    â€¢ ModeSelector + Assistant WIDIP                                    â”‚
â”‚    â€¢ API service adaptÃ©                                                â”‚
â”‚    â€¢ Tests frontend                                                    â”‚
â”‚                                                                         â”‚
â”‚  â–¡ Jour 5: Tests end-to-end WIBOT                                      â”‚
â”‚    â€¢ Tous les modes                                                    â”‚
â”‚    â€¢ Streaming                                                         â”‚
â”‚    â€¢ RAG                                                               â”‚
â”‚                                                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                         â”‚
â”‚  PHASE 2.2 : SAFEGUARD UI (1 semaine)                                  â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                 â”‚
â”‚                                                                         â”‚
â”‚  Semaine 5:                                                            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                            â”‚
â”‚  â–¡ Jour 1-2: Backend SAFEGUARD routes                                  â”‚
â”‚    â€¢ Connexion SAFEGUARD Phase 1                                       â”‚
â”‚    â€¢ Enrichissement contexte ticket                                    â”‚
â”‚    â€¢ WebSocket channel                                                 â”‚
â”‚                                                                         â”‚
â”‚  â–¡ Jour 3-4: Frontend SAFEGUARD                                        â”‚
â”‚    â€¢ WebSocket integration                                             â”‚
â”‚    â€¢ Contexte ticket display                                           â”‚
â”‚    â€¢ Real-time updates                                                 â”‚
â”‚    â€¢ Browser notifications                                             â”‚
â”‚                                                                         â”‚
â”‚  â–¡ Jour 5: Tests SAFEGUARD                                             â”‚
â”‚    â€¢ Approve/Reject flow                                               â”‚
â”‚    â€¢ WebSocket reliability                                             â”‚
â”‚                                                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                         â”‚
â”‚  PHASE 2.3 : Supervision Dashboards (2 semaines)                       â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                       â”‚
â”‚                                                                         â”‚
â”‚  Semaine 6:                                                            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                            â”‚
â”‚  â–¡ Jour 1-2: Backend supervision                                       â”‚
â”‚    â€¢ Metrics aggregation service                                       â”‚
â”‚    â€¢ Overview endpoint                                                 â”‚
â”‚    â€¢ SUPPORT endpoint                                                  â”‚
â”‚    â€¢ SENTINEL endpoint                                                 â”‚
â”‚                                                                         â”‚
â”‚  â–¡ Jour 3-4: Frontend Overview                                         â”‚
â”‚    â€¢ Home.tsx (menu principal)                                         â”‚
â”‚    â€¢ Overview.tsx (KPIs, health, activity)                             â”‚
â”‚    â€¢ Navigation layout                                                 â”‚
â”‚                                                                         â”‚
â”‚  â–¡ Jour 5: Tests Overview                                              â”‚
â”‚                                                                         â”‚
â”‚  Semaine 7:                                                            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                            â”‚
â”‚  â–¡ Jour 1-2: Dashboard SUPPORT                                         â”‚
â”‚    â€¢ Tickets par catÃ©gorie                                             â”‚
â”‚    â€¢ Actions timeline                                                  â”‚
â”‚    â€¢ Erreurs display                                                   â”‚
â”‚                                                                         â”‚
â”‚  â–¡ Jour 3-4: Dashboard SENTINEL                                        â”‚
â”‚    â€¢ Clients impactÃ©s                                                  â”‚
â”‚    â€¢ ResponsabilitÃ© breakdown                                          â”‚
â”‚    â€¢ Timeline alertes                                                  â”‚
â”‚                                                                         â”‚
â”‚  â–¡ Jour 5: Dashboards ENRICHISSEUR + SAFEGUARD stats                   â”‚
â”‚    â€¢ RAG stats                                                         â”‚
â”‚    â€¢ Approval analytics                                                â”‚
â”‚                                                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                         â”‚
â”‚  PHASE 2.4 : Users & Admin (1 semaine)                                 â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                 â”‚
â”‚                                                                         â”‚
â”‚  Semaine 8:                                                            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                            â”‚
â”‚  â–¡ Jour 1-2: Backend users                                             â”‚
â”‚    â€¢ CRUD users                                                        â”‚
â”‚    â€¢ Roles & permissions                                               â”‚
â”‚    â€¢ Quotas tokens                                                     â”‚
â”‚                                                                         â”‚
â”‚  â–¡ Jour 3-4: Audit logging                                             â”‚
â”‚    â€¢ Audit service                                                     â”‚
â”‚    â€¢ Log all actions                                                   â”‚
â”‚    â€¢ Audit viewer UI                                                   â”‚
â”‚                                                                         â”‚
â”‚  â–¡ Jour 5: Tests users + audit                                         â”‚
â”‚                                                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                         â”‚
â”‚  PHASE 2.5 : Polish & Deploy (1 semaine)                               â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                               â”‚
â”‚                                                                         â”‚
â”‚  Semaine 9:                                                            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                            â”‚
â”‚  â–¡ Jour 1-2: Tests E2E                                                 â”‚
â”‚    â€¢ Playwright/Cypress tests                                          â”‚
â”‚    â€¢ Full user journeys                                                â”‚
â”‚                                                                         â”‚
â”‚  â–¡ Jour 3: Documentation                                               â”‚
â”‚    â€¢ Guide utilisateur                                                 â”‚
â”‚    â€¢ API documentation (OpenAPI)                                       â”‚
â”‚                                                                         â”‚
â”‚  â–¡ Jour 4: Cleanup                                                     â”‚
â”‚    â€¢ Supprimer workflows n8n WIBOT (garder RAG)                        â”‚
â”‚    â€¢ Optimisations                                                     â”‚
â”‚                                                                         â”‚
â”‚  â–¡ Jour 5: DÃ©ploiement production                                      â”‚
â”‚    â€¢ HTTPS setup                                                       â”‚
â”‚    â€¢ Monitoring                                                        â”‚
â”‚    â€¢ Formation Ã©quipe                                                  â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.2 Livrables par phase

| Phase | DurÃ©e | Livrables |
|-------|-------|-----------|
| **2.0 Fondations** | 2 sem | Auth bcrypt, JWT, WebSocket infra, DB migrations |
| **2.1 WIBOT Core** | 2 sem | Chat backend, LLM, RAG, Mode Assistant WIDIP |
| **2.2 SAFEGUARD UI** | 1 sem | WebSocket real-time, contexte ticket, notifications |
| **2.3 Supervision** | 2 sem | 5 dashboards (Overview, SUPPORT, SENTINEL, ENRICHISSEUR, SAFEGUARD) |
| **2.4 Users** | 1 sem | CRUD users, quotas, audit log |
| **2.5 Polish** | 1 sem | Tests E2E, docs, dÃ©ploiement, cleanup n8n |

### 8.3 CritÃ¨res de succÃ¨s Phase 2

| CritÃ¨re | Mesure | Cible |
|---------|--------|-------|
| WIBOT fonctionnel | 4 modes opÃ©rationnels | 100% |
| Mode Assistant WIDIP | Appels MCP rÃ©ussis | > 95% |
| SAFEGUARD real-time | Latence WebSocket | < 500ms |
| Dashboards | 5 dashboards actifs | 100% |
| SÃ©curitÃ© | Passwords bcrypt | 100% |
| Tests | Coverage | > 80% |

---

## Annexes

### A. Mapping routes n8n â†’ Python

| Route n8n actuelle | Route Python Phase 2 |
|--------------------|---------------------|
| POST /webhook/auth/login | POST /api/auth/login |
| POST /webhook/wibot/chat | POST /api/chat/message |
| GET /webhook/wibot/conversations | GET /api/chat/conversations |
| POST /webhook/wibot/conversation | POST /api/chat/conversations |
| GET /webhook/wibot/safeguard/pending | GET /api/safeguard/pending |
| POST /webhook/wibot/safeguard/:id/approve | POST /api/safeguard/:id/approve |
| GET /webhook/wibot/analytics | GET /api/supervision/overview |
| GET /webhook/wibot/admin/users | GET /api/users |

### B. Variables d'environnement Phase 2

```bash
# Auth
JWT_SECRET=your-very-long-secret-key-at-least-32-chars
JWT_EXPIRE_HOURS=8

# Database
DATABASE_URL=postgresql://user:pass@localhost:5432/widip

# Redis
REDIS_URL=redis://localhost:6379

# MCP Server
MCP_SERVER_URL=http://localhost:3001
MCP_API_KEY=your-mcp-api-key

# LLM
OLLAMA_BASE_URL=http://localhost:11434
MISTRAL_API_KEY=your-mistral-key  # optionnel

# Frontend
CORS_ORIGINS=http://localhost:8080,http://localhost:5173

# Rate limiting
RATE_LIMIT_PER_MINUTE=100
```

---

**Document rÃ©digÃ© le 2026-01-06**
**Version 1.0 - ValidÃ© en discussion**
